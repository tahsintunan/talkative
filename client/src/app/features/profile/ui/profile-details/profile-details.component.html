<div class="card relative h-64 flex flex-col">
  <img
    [src]="data?.username | generateImage: 'background'"
    class="absolute inset-0 w-full h-full object-cover rounded-md"
  />

  <div class="absolute top-[42%] left-0 right-0 px-8 flex items-center gap-5">
    <app-avatar
      size="170px"
      [src]="data?.username"
      [generateAvater]="true"
      borderColor="#fafafa"
      borderWidth="10px"
      borderRadius="50%"
      bgColor="#fff"
    >
    </app-avatar>

    <div class="flex flex-col gap-1 text-gray-700">
      <h1 class="text-2xl font-bold text-gray-800">
        {{ data?.username }}
      </h1>

      <p>{{ data?.email }}</p>

      <p>{{ utilityService.getAge(data?.dateOfBirth!) }} years old</p>
    </div>

    <div class="flex justify-center gap-4 ml-auto">
      <div class="flex flex-col items-center">
        <p class="text-gray-800 font-bold">
          {{ analytics?.followerCount | shortNumber }}
        </p>
        <p>Followers</p>
      </div>

      <mat-divider vertical="true"></mat-divider>

      <div class="flex flex-col items-center">
        <p class="text-gray-800 font-bold">
          {{ analytics?.followingCount | shortNumber }}
        </p>
        <p>Following</p>
      </div>
    </div>
  </div>

  <div class="absolute top-0 right-3 z-10 flex gap-2 flex-wrap p-4">
    <ng-container *ngIf="userAuth?.userId === data?.userId; else followBtns">
      <button
        class="transition flex gap-2 items-center px-4 py-2 rounded-md text-sm font-medium border shadow-sm text-gray-700 bg-white hover:bg-gray-50 outline-none"
        (click)="onProfileEdit.emit()"
      >
        Edit Profile <span class="material-symbols-rounded">edit</span>
      </button>

      <button
        class="transition flex gap-2 items-center px-4 py-2 rounded-md text-sm font-medium border shadow-sm text-gray-700 bg-white hover:bg-gray-50 outline-none"
        (click)="onPasswordEdit.emit()"
      >
        Change Password <span class="material-symbols-rounded">key</span>
      </button>
    </ng-container>
  </div>
</div>

<ng-template #followBtns>
  <button
    *ngIf="!userBlocked"
    class="transition flex gap-2 items-center px-4 py-2 rounded-md text-sm font-medium border shadow-sm text-gray-700 bg-white hover:bg-gray-50 outline-none"
    (click)="onBlockClick.emit()"
  >
    Block <span class="material-symbols-rounded">person_off</span>
  </button>

  <button
    *ngIf="userBlocked"
    class="transition flex gap-2 items-center px-4 py-2 rounded-md text-sm font-medium border shadow-sm text-gray-700 bg-white hover:bg-gray-50 outline-none"
    (click)="onUnblockClick.emit()"
  >
    Unblock <span class="material-symbols-rounded">how_to_reg</span>
  </button>

  <button
    *ngIf="!isFollowing && !userBlocked"
    class="transition flex gap-2 items-center px-4 py-2 rounded-md text-sm font-medium border shadow-sm text-gray-700 bg-white hover:bg-gray-50 outline-none"
    (click)="onFollowClick.emit()"
  >
    Follow <span class="material-symbols-rounded">person_add</span>
  </button>

  <button
    *ngIf="isFollowing && !userBlocked"
    class="transition flex gap-2 items-center px-4 py-2 rounded-md text-sm font-medium border shadow-sm text-gray-700 bg-white hover:bg-gray-50 outline-none"
    (click)="onUnfollowClick.emit()"
  >
    Unfollow <span class="material-symbols-rounded">person_remove</span>
  </button>
</ng-template>
